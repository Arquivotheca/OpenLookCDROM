head     1.7;
branch   ;
access   ;
symbols  ;
locks    ;
comment  @# @;


1.7
date     92.06.24.12.04.19;  author ian;  state Exp;
branches ;
next     1.6;

1.6
date     92.06.24.11.52.24;  author ian;  state Exp;
branches ;
next     1.5;

1.5
date     92.06.24.11.39.10;  author ian;  state Exp;
branches ;
next     1.4;

1.4
date     92.06.02.13.17.41;  author ian;  state Exp;
branches ;
next     1.3;

1.3
date     91.11.28.13.46.44;  author ian;  state Exp;
branches ;
next     1.2;

1.2
date     91.11.28.12.54.21;  author ian;  state Exp;
branches ;
next     1.1;

1.1
date     91.11.28.12.52.20;  author ian;  state Exp;
branches ;
next     ;


desc
@Makefile for timeRecorder program
@


1.7
log
@Simplify; make install now does local. Remote now loops copying non-bins.
@
text
@# This file was generated by `gxv' from `timer.G'.
# $Id: Makefile,v 1.6 92/06/24 11:52:24 ian Exp $

# Parameters.

PROGRAM = timekeeper
SOURCES.c = topics.c logfile.c
SOURCES.h = 
SOURCES.G = timer.G
STUBS.G = timer.G

OTHERPROGS = tk tkrefmt
BINDIR = /usr/local/bin
LIBDIR = /usr/local/lib/timekeeper

# Derived parameters.

SOURCES = \
	$(SOURCES.G) \
	$(SOURCES.h) \
	$(SOURCES.l) \
	$(SOURCES.y) \
	$(SOURCES.c)

TARGETS.c = \
	$(SOURCES.G:%.G=%_ui.c) \
	$(STUBS.G:%.G=%_stubs.c)

TARGETS.h = \
	$(SOURCES.G:%.G=%_ui.h) \
	$(SOURCES.l:%.l=%.h) \
	$(SOURCES.y:%.y=%.h)

TARGETS.other = tk \
	$(SOURCES.G:%.G=%.info)

TARGETS = \
	$(OTHERPROGS) \
	$(TARGETS.other) \
	$(TARGETS.h) \
	$(TARGETS.c)

OBJECTS = \
	$(SOURCES.c:%.c=%.o) \
	$(TARGETS.c:%.c=%.o)

# Compiler flags.

CFLAGS += -g
CPPFLAGS += -I$(GUIDEHOME)/include -I$(OPENWINHOME)/include -DMAIN
LDFLAGS += -L$(GUIDEHOME)/lib -L$(OPENWINHOME)/lib
LDLIBS += -lguidexv -lguide -lxview -lolgx -lX11

# Standard targets.
all:	 $(TARGETS.other) $(PROGRAM)
objects: $(SOURCES.c) $(TARGETS.c) $(TARGETS.h) $(OBJECTS)
sources: $(SOURCES)
targets: $(SOURCES) $(TARGETS)

install:	all
		install -s -m 755 $(PROGRAM) $(OTHERPROGS) $(BINDIR)
		install default-tasks $(LIBDIR)/tasks
		install tksumm.awk $(LIBDIR)
		install timekeeper.1 /usr/local/man/man1/timekeeper.1
		-ln /usr/local/man/man1/timekeeper.1 /usr/local/man/man1/tk.1
install.remote:	all
		for host in sq sqlee; \
		do \
			rcp tk $$host:$(BINDIR)/tk; \
			rcp tksumm.awk $$host:$(LIBDIR)/tksumm.awk; \
			rcp default-tasks $$host:$(LIBDIR)/tasks; \
		done
		rcp timekeeper sqlee:/usr/local/bin

$(PROGRAM): $(SOURCES.c) $(TARGETS.c) $(TARGETS.h) $(OBJECTS)
	$(LINK.c) -o $@@ $(OBJECTS) $(LDLIBS)

timer_stubs.o:	punchclock.icon nobilling.icon

# program that converts from our format to tksumm format.
tkrefmt:	tkrefmt.c
		$(CC) $? -o $@@

tk:		tk.sh
		cp $? $@@

# Targets to be used by Saber-C.

saber_src:
	#load $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) $(TARGET_ARCH) \
		$(SOURCES.c) $(TARGETS.c) $(LDLIBS)

saber_obj:
	#load $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) $(TARGET_ARCH) $(OBJECTS) $(LDLIBS)

clean:
	$(RM) $(SOURCES.G:%.G=%_ui.c) $(TARGETS.other) $(TARGETS.h) $(OBJECTS) *.BAK *.delta core

%_ui.c: %.G
	$(GUIDEHOME)/bin/gxv  $*

%_ui.h: %_ui.c
	@@touch $@@

%_stubs.c: %_ui.c
	@@touch $@@

%.info: %_ui.c
	@@touch $@@
@


1.6
log
@New, more complicated(!) install; does either remote or local. Try it!
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.5 92/06/24 11:39:10 ian Exp $
d13 1
d61 2
a62 5
		@@echo "Please make install.{local,remote,all}"
install.all:	install.local install.remote
install.local:	all
		install -s -m 755 $(PROGRAM) $(OTHERPROGS) /usr/local/bin
		install default-topics $(LIBDIR)/topics
d67 7
a73 2
		rcp tk sq:/usr/local/bin/tk
		rcp tk timekeeper sqlee:/usr/local/bin
@


1.5
log
@Tksumm no longer a seperate program; use tk -s.
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.4 92/06/02 13:17:41 ian Exp $
d60 3
d68 1
@


1.4
log
@Numerous minor changes, and an all-new install rule.
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.3 91/11/28 13:46:44 ian Exp $
d12 1
a12 1
OTHERPROGS = tk tkrefmt tksumm 
@


1.3
log
@< PROGRAM = timerecorder
> PROGRAM = timekeeper
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.2 91/11/28 12:54:21 ian Exp $
d12 3
d33 1
a33 1
TARGETS.other = \
d37 1
a53 1

d59 9
d70 9
@


1.2
log
@Add RCS ID.
@
text
@d2 1
a2 1
# $Id$
d6 1
a6 1
PROGRAM = timerecorder
@


1.1
log
@Initial revision
@
text
@d2 1
@
